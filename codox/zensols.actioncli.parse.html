<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>zensols.actioncli.parse documentation</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="css/highlight.css" /><script type="text/javascript" src="js/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Action CLI</span> <span class="project-version">0.0.30</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>zensols</span></div></div></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>actioncli</span></div></div></li><li class="depth-3 branch"><a href="zensols.actioncli.dynamic.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>dynamic</span></div></a></li><li class="depth-3 branch"><a href="zensols.actioncli.io.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>io</span></div></a></li><li class="depth-3 branch"><a href="zensols.actioncli.log4j2.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>log4j2</span></div></a></li><li class="depth-3 branch"><a href="zensols.actioncli.ns.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>ns</span></div></a></li><li class="depth-3 branch current"><a href="zensols.actioncli.parse.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>parse</span></div></a></li><li class="depth-3 branch"><a href="zensols.actioncli.repl.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>repl</span></div></a></li><li class="depth-3 branch"><a href="zensols.actioncli.resource.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>resource</span></div></a></li><li class="depth-3 branch"><a href="zensols.actioncli.util.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>util</span></div></a></li><li class="depth-3"><a href="zensols.actioncli.version.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>version</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="zensols.actioncli.parse.html#var-*dump-jvm-on-error*"><div class="inner"><span>*dump-jvm-on-error*</span></div></a></li><li class="depth-1"><a href="zensols.actioncli.parse.html#var-*include-program-in-errors*"><div class="inner"><span>*include-program-in-errors*</span></div></a></li><li class="depth-1"><a href="zensols.actioncli.parse.html#var-*log-error*"><div class="inner"><span>*log-error*</span></div></a></li><li class="depth-1"><a href="zensols.actioncli.parse.html#var-*parse-context*"><div class="inner"><span>*parse-context*</span></div></a></li><li class="depth-1"><a href="zensols.actioncli.parse.html#var-*rethrow-error*"><div class="inner"><span>*rethrow-error*</span></div></a></li><li class="depth-1"><a href="zensols.actioncli.parse.html#var-create-actions"><div class="inner"><span>create-actions</span></div></a></li><li class="depth-1"><a href="zensols.actioncli.parse.html#var-create-default-usage-format"><div class="inner"><span>create-default-usage-format</span></div></a></li><li class="depth-1"><a href="zensols.actioncli.parse.html#var-error-msg"><div class="inner"><span>error-msg</span></div></a></li><li class="depth-1"><a href="zensols.actioncli.parse.html#var-handle-exception"><div class="inner"><span>handle-exception</span></div></a></li><li class="depth-1"><a href="zensols.actioncli.parse.html#var-help-message"><div class="inner"><span>help-message</span></div></a></li><li class="depth-1"><a href="zensols.actioncli.parse.html#var-help-option"><div class="inner"><span>help-option</span></div></a></li><li class="depth-1"><a href="zensols.actioncli.parse.html#var-multi-action-context"><div class="inner"><span>multi-action-context</span></div></a></li><li class="depth-1"><a href="zensols.actioncli.parse.html#var-print-error-message"><div class="inner"><span>print-error-message</span></div></a></li><li class="depth-1"><a href="zensols.actioncli.parse.html#var-process-arguments"><div class="inner"><span>process-arguments</span></div></a></li><li class="depth-1"><a href="zensols.actioncli.parse.html#var-program-name"><div class="inner"><span>program-name</span></div></a></li><li class="depth-1"><a href="zensols.actioncli.parse.html#var-set-program-name"><div class="inner"><span>set-program-name</span></div></a></li><li class="depth-1"><a href="zensols.actioncli.parse.html#var-single-action-context"><div class="inner"><span>single-action-context</span></div></a></li><li class="depth-1"><a href="zensols.actioncli.parse.html#var-version-option"><div class="inner"><span>version-option</span></div></a></li><li class="depth-1"><a href="zensols.actioncli.parse.html#var-with-exception"><div class="inner"><span>with-exception</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">zensols.actioncli.parse</h1><div class="doc"><div class="markdown"><p>Parse action based command line arguments.</p></div></div><div class="public anchor" id="var-*dump-jvm-on-error*"><h3>*dump-jvm-on-error*</h3><h4 class="dynamic">dynamic</h4><div class="usage"></div><div class="doc"><div class="markdown"><p>Bind this from the REPL to avoid a system exit when testing the CLI.</p></div></div><div class="src-link"><a href="https://github.com/plandes/clj-actioncli/blob/v0.0.30/src/clojure/zensols/actioncli/parse.clj#L8">view source</a></div></div><div class="public anchor" id="var-*include-program-in-errors*"><h3>*include-program-in-errors*</h3><h4 class="dynamic">dynamic</h4><div class="usage"></div><div class="doc"><div class="markdown"><p>If non-nil add program name to error and warning messages in <a href="zensols.actioncli.parse.html#var-handle-exception">handle-exception</a> and <a href="null">error-message</a> and <a href="zensols.actioncli.parse.html#var-print-error-message">print-error-message</a>.</p></div></div><div class="src-link"><a href="https://github.com/plandes/clj-actioncli/blob/v0.0.30/src/clojure/zensols/actioncli/parse.clj#L36">view source</a></div></div><div class="public anchor" id="var-*log-error*"><h3>*log-error*</h3><h4 class="dynamic">dynamic</h4><div class="usage"></div><div class="doc"><div class="markdown"><p>Log exceptions in <a href="zensols.actioncli.parse.html#var-handle-exception">handle-exception</a>.</p></div></div><div class="src-link"><a href="https://github.com/plandes/clj-actioncli/blob/v0.0.30/src/clojure/zensols/actioncli/parse.clj#L12">view source</a></div></div><div class="public anchor" id="var-*parse-context*"><h3>*parse-context*</h3><h4 class="dynamic">dynamic</h4><div class="usage"></div><div class="doc"><div class="markdown"><p>This context is bound when calling action bound functions. This is useful when other functions in this namespace need to be called with parse information.</p>
<p>This context is a map with the following keys:</p>
<ul>
  <li><strong>:action-context</strong> the context created with <a href="zensols.actioncli.parse.html#var-multi-action-context">multi-action-context</a> or <a href="zensols.actioncli.parse.html#var-single-action-context">single-action-context</a></li>
  <li><strong>:arguments</strong> the arguments passed to the parse function</li>
  <li><strong>:options</strong> the parsed options</li>
  <li><strong>:single-action-mode?</strong> whether the action context was created with <a href="zensols.actioncli.parse.html#var-multi-action-context">multi-action-context</a> or <a href="zensols.actioncli.parse.html#var-single-action-context">single-action-context</a></li>
</ul></div></div><div class="src-link"><a href="https://github.com/plandes/clj-actioncli/blob/v0.0.30/src/clojure/zensols/actioncli/parse.clj#L21">view source</a></div></div><div class="public anchor" id="var-*rethrow-error*"><h3>*rethrow-error*</h3><h4 class="dynamic">dynamic</h4><div class="usage"></div><div class="doc"><div class="markdown"><p>When not dying on error with <a href="zensols.actioncli.parse.html#var-*dump-jvm-on-error*">*dump-jvm-on-error*</a> also don’t rethrow the exception in <a href="zensols.actioncli.parse.html#var-handle-exception">handle-exception</a>.</p></div></div><div class="src-link"><a href="https://github.com/plandes/clj-actioncli/blob/v0.0.30/src/clojure/zensols/actioncli/parse.clj#L16">view source</a></div></div><div class="public anchor" id="var-create-actions"><h3>create-actions</h3><div class="usage"><code>(create-actions action-context)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/plandes/clj-actioncli/blob/v0.0.30/src/clojure/zensols/actioncli/parse.clj#L207">view source</a></div></div><div class="public anchor" id="var-create-default-usage-format"><h3>create-default-usage-format</h3><div class="usage"><code>(create-default-usage-format)</code><code>(create-default-usage-format usage-format)</code></div><div class="doc"><div class="markdown"><p>Create a function that formats the usage statement.</p></div></div><div class="src-link"><a href="https://github.com/plandes/clj-actioncli/blob/v0.0.30/src/clojure/zensols/actioncli/parse.clj#L84">view source</a></div></div><div class="public anchor" id="var-error-msg"><h3>error-msg</h3><div class="usage"><code>(error-msg errors)</code></div><div class="doc"><div class="markdown"><p>Print every element of the sequence <strong>errors</strong>. If there <strong>errors</strong> is a singleton then only print one in the common usage format.</p></div></div><div class="src-link"><a href="https://github.com/plandes/clj-actioncli/blob/v0.0.30/src/clojure/zensols/actioncli/parse.clj#L261">view source</a></div></div><div class="public anchor" id="var-handle-exception"><h3>handle-exception</h3><div class="usage"><code>(handle-exception e)</code></div><div class="doc"><div class="markdown"><p>Handle exceptions thrown from CLI actions.</p>
<p>See:</p>
<ul>
  <li><a href="zensols.actioncli.parse.html#var-*include-program-in-errors*">*include-program-in-errors*</a></li>
  <li><a href="zensols.actioncli.parse.html#var-*rethrow-error*">*rethrow-error*</a></li>
  <li><a href="zensols.actioncli.parse.html#var-*log-error*">*log-error*</a></li>
</ul></div></div><div class="src-link"><a href="https://github.com/plandes/clj-actioncli/blob/v0.0.30/src/clojure/zensols/actioncli/parse.clj#L221">view source</a></div></div><div class="public anchor" id="var-help-message"><h3>help-message</h3><div class="usage"><code>(help-message &amp; {:keys [action-key usage], :or {usage true}})</code></div><div class="doc"><div class="markdown"><p>Generate the help message text and return it. The <strong>action-key</strong> is a keyword of the passed as a command to <a href="zensols.actioncli.parse.html#var-multi-action-context">multi-action-context</a>. By default the usage text is included unless the <code>:usage</code> key is <code>false</code>. If the <code>:usage</code> is the symbol <code>only</code> then only create the usage text and not the action/parameters.</p></div></div><div class="src-link"><a href="https://github.com/plandes/clj-actioncli/blob/v0.0.30/src/clojure/zensols/actioncli/parse.clj#L112">view source</a></div></div><div class="public anchor" id="var-help-option"><h3>help-option</h3><div class="usage"><code>(help-option)</code><code>(help-option short long)</code></div><div class="doc"><div class="markdown"><p>Return an option that provides version information.</p></div></div><div class="src-link"><a href="https://github.com/plandes/clj-actioncli/blob/v0.0.30/src/clojure/zensols/actioncli/parse.clj#L59">view source</a></div></div><div class="public anchor" id="var-multi-action-context"><h3>multi-action-context</h3><div class="usage"><code>(multi-action-context actions &amp; {:keys [global-actions help-option version-option action-print-order print-help-fn usage-format-fn no-action-fn default-arguments], :or {help-option (help-option), no-action-fn (fn [] (println (help-message)))}})</code></div><div class="doc"><div class="markdown"><p>Create a multi-action context with map <strong>action</strong>. These don’t include the  name of the action on the command line and are typical UNIX like command  lines (ex: <code>ls</code>, <code>grep</code>, etc).</p>
<p>The parameter is <strong>action</strong> is a list of list of symbols takes the form:</p>
<pre><code>'((:action-name1 package1 action1)
  ...)
</code></pre>
<p>where <strong>action-name</strong> is a key, <strong>package</strong> is the package and <strong>action</strong> is  the action definition.</p>
<h2><a href="#keys" name="keys"></a>Keys</h2>
<ul>
  <li><strong>help-option:</strong> the help action command, which defaults to <a href="zensols.actioncli.parse.html#var-help-option">help-option</a></li>
  <li><strong>version-option:</strong> usually created with <a href="zensols.actioncli.parse.html#var-version-option">version-option</a></li>
  <li><strong>global-actions:</strong> addition global actions in addition to the help and  version options listed above</li>
  <li><strong>action-print-order:</strong> an optional sequence of action name keys indicating  what order to print action help</li>
  <li><strong>print-help-fn:</strong> an optional function that takes a string argument of the  generated option help to provide a way to customize the help message</li>
  <li><strong>usage-format-fn:</strong> generate the usage portion of the help message that  takes the names of all action if generating multi-action usage or nil for  single action usage messages</li>
  <li><strong>:no-action-fn</strong> a function to call when no action is given, defaults to  printing the contents of <a href="zensols.actioncli.parse.html#var-help-message">help-message</a>; set to <code>nil</code> to continue  processing without an action</li>
</ul></div></div><div class="src-link"><a href="https://github.com/plandes/clj-actioncli/blob/v0.0.30/src/clojure/zensols/actioncli/parse.clj#L142">view source</a></div></div><div class="public anchor" id="var-print-error-message"><h3>print-error-message</h3><div class="usage"><code>(print-error-message errors)</code></div><div class="doc"><div class="markdown"><p>Print errors messages generated by <a href="null">error-message</a>.</p></div></div><div class="src-link"><a href="https://github.com/plandes/clj-actioncli/blob/v0.0.30/src/clojure/zensols/actioncli/parse.clj#L272">view source</a></div></div><div class="public anchor" id="var-process-arguments"><h3>process-arguments</h3><div class="usage"><code>(process-arguments action-context args)</code></div><div class="doc"><div class="markdown"><p>Process the action line, which contains the action (action) and arguments  <code>args</code>.</p>
<p>The action context is a map with actions. Actions in turn contains what to  run when an action is given.</p>
<p>An example of an action context:</p>
<pre><code class="clojure">(defn- create-action-context []
  (multi-action-context
   '((:service com.example service start-server-action)
     (:repl zensols.actioncli repl repl-action))
   :version-option
   (-&gt;&gt; (fn [] (println "version string"))
        version-option)
   :default-arguments ["service" "-p" "8080"]))
</code></pre>
<p>See the <a href="https://github.com/plandes/clj-actioncli">main document page</a> for  more info.</p></div></div><div class="src-link"><a href="https://github.com/plandes/clj-actioncli/blob/v0.0.30/src/clojure/zensols/actioncli/parse.clj#L339">view source</a></div></div><div class="public anchor" id="var-program-name"><h3>program-name</h3><div class="usage"><code>(program-name)</code></div><div class="doc"><div class="markdown"><p>Return the program name used for info/error message. This is set with <a href="zensols.actioncli.parse.html#var-set-program-name">set-program-name</a>.</p></div></div><div class="src-link"><a href="https://github.com/plandes/clj-actioncli/blob/v0.0.30/src/clojure/zensols/actioncli/parse.clj#L43">view source</a></div></div><div class="public anchor" id="var-set-program-name"><h3>set-program-name</h3><div class="usage"><code>(set-program-name program-name)</code></div><div class="doc"><div class="markdown"><p>Set the program name used for info/error message.</p></div></div><div class="src-link"><a href="https://github.com/plandes/clj-actioncli/blob/v0.0.30/src/clojure/zensols/actioncli/parse.clj#L54">view source</a></div></div><div class="public anchor" id="var-single-action-context"><h3>single-action-context</h3><div class="usage"><code>(single-action-context action &amp; options)</code></div><div class="doc"><div class="markdown"><p>Create a single action context with map <strong>action</strong>. These don’t include the  name of the action on the command line and are typical UNIX like command  lines (ex: <code>ls</code>, <code>grep</code>, etc).</p>
<p>The parameter is <strong>action</strong> is a list of symbols that takes the form:</p>
<pre><code>'(package action)
</code></pre>
<p>where <strong>package</strong> is the package and <strong>action</strong> is the action definition.</p>
<p>See <a href="zensols.actioncli.parse.html#var-multi-action-context">multi-action-context</a> for the description of <strong>options</strong>.</p></div></div><div class="src-link"><a href="https://github.com/plandes/clj-actioncli/blob/v0.0.30/src/clojure/zensols/actioncli/parse.clj#L189">view source</a></div></div><div class="public anchor" id="var-version-option"><h3>version-option</h3><div class="usage"><code>(version-option print-fn)</code><code>(version-option print-fn short long)</code></div><div class="doc"><div class="markdown"><p>Return an option that provides version information. The option uses <strong>print-fn</strong> to print the version of the program.</p></div></div><div class="src-link"><a href="https://github.com/plandes/clj-actioncli/blob/v0.0.30/src/clojure/zensols/actioncli/parse.clj#L71">view source</a></div></div><div class="public anchor" id="var-with-exception"><h3>with-exception</h3><h4 class="type">macro</h4><div class="usage"><code>(with-exception &amp; forms)</code></div><div class="doc"><div class="markdown"><p>Wrap a CLI forms in a <code>try</code> and call <a href="zensols.actioncli.parse.html#var-handle-exception">handle-exception</a> if an exception occurs.</p></div></div><div class="src-link"><a href="https://github.com/plandes/clj-actioncli/blob/v0.0.30/src/clojure/zensols/actioncli/parse.clj#L250">view source</a></div></div></div></body></html>