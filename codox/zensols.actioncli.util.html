<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>zensols.actioncli.util documentation</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="css/highlight.css" /><script type="text/javascript" src="js/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Action CLI</span> <span class="project-version">0.0.30</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>zensols</span></div></div></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>actioncli</span></div></div></li><li class="depth-3 branch"><a href="zensols.actioncli.dynamic.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>dynamic</span></div></a></li><li class="depth-3 branch"><a href="zensols.actioncli.io.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>io</span></div></a></li><li class="depth-3 branch"><a href="zensols.actioncli.log4j2.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>log4j2</span></div></a></li><li class="depth-3 branch"><a href="zensols.actioncli.ns.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>ns</span></div></a></li><li class="depth-3 branch"><a href="zensols.actioncli.parse.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>parse</span></div></a></li><li class="depth-3 branch"><a href="zensols.actioncli.repl.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>repl</span></div></a></li><li class="depth-3 branch"><a href="zensols.actioncli.resource.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>resource</span></div></a></li><li class="depth-3 branch current"><a href="zensols.actioncli.util.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>util</span></div></a></li><li class="depth-3"><a href="zensols.actioncli.version.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>version</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="zensols.actioncli.util.html#var-*trunc-len*"><div class="inner"><span>*trunc-len*</span></div></a></li><li class="depth-1"><a href="zensols.actioncli.util.html#var-defnlock"><div class="inner"><span>defnlock</span></div></a></li><li class="depth-1"><a href="zensols.actioncli.util.html#var-defnpool"><div class="inner"><span>defnpool</span></div></a></li><li class="depth-1"><a href="zensols.actioncli.util.html#var-defnprime"><div class="inner"><span>defnprime</span></div></a></li><li class="depth-1"><a href="zensols.actioncli.util.html#var-parse-macro-arguments"><div class="inner"><span>parse-macro-arguments</span></div></a></li><li class="depth-1"><a href="zensols.actioncli.util.html#var-pool-item-status"><div class="inner"><span>pool-item-status</span></div></a></li><li class="depth-1"><a href="zensols.actioncli.util.html#var-trunc"><div class="inner"><span>trunc</span></div></a></li><li class="depth-1"><a href="zensols.actioncli.util.html#var-with-timeout"><div class="inner"><span>with-timeout</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">zensols.actioncli.util</h1><div class="doc"><div class="markdown"><p>Utility functions</p></div></div><div class="public anchor" id="var-*trunc-len*"><h3>*trunc-len*</h3><h4 class="dynamic">dynamic</h4><div class="usage"></div><div class="doc"><div class="markdown"><p>Default truncation length for <a href="zensols.actioncli.util.html#var-trunc">trunc</a>.</p></div></div><div class="src-link"><a href="https://github.com/plandes/clj-actioncli/blob/v0.0.30/src/clojure/zensols/actioncli/util.clj#L10">view source</a></div></div><div class="public anchor" id="var-defnlock"><h3>defnlock</h3><h4 class="type">macro</h4><div class="usage"><code>(defnlock attr-map? name doc-string? [params*] body)</code><code>(defnlock name doc-string? [params*] body)</code><code>(defnlock name [params*] body)</code></div><div class="doc"><div class="markdown"><p>Just like <code>defn</code> but create an atom instance used to generate the result (resource) by calling <strong>body</strong> only once.</p>
<p>This creates a function <strong>name</strong> that invokes <strong>body</strong> the first time it is invoked. It then caches the solution and returns it on the next call. This is all done in a <a href="null">clojure.core/locking</a> lexical context to make this first call and resource creation thread-safe.</p>
<p>The result it saves is kept in the metadata under key <code>:init-resource</code>.</p></div></div><div class="src-link"><a href="https://github.com/plandes/clj-actioncli/blob/v0.0.30/src/clojure/zensols/actioncli/util.clj#L84">view source</a></div></div><div class="public anchor" id="var-defnpool"><h3>defnpool</h3><h4 class="type">macro</h4><div class="usage"><code>(defnpool attr-map? name [symbol factory-fn config?] doc-string? [params*] body)</code><code>(defnpool name [symbol config factory-fn] doc-string? [params*] body)</code><code>(defnpool name [symbol config factory-fn] [params*] body)</code></div><div class="doc"><div class="markdown"><p>Create a function called <strong>name</strong> that pools objects. The pool resources are bound to <strong>item-symbol</strong> and created with function <strong>factory-fn</strong>. The <strong>config</strong> parameter determines how pooling is done with the following default configuration:</p>
<pre><code>{:max-total -1
 :max-idle 8
 :min-idle 0}
</code></pre>
<p><em>Note:</em> The configuration form is optional.</p>
<h2><a href="#example" name="example"></a>Example</h2>
<pre><code>(defnpool pool1 [pooled-item
                 #(java.util.Date.)
                 {:max-total 5}]
  [arg1]
  (str pooled-item arg1))
</code></pre>
<p>Creates a function <code>pool</code> that takes one argument (<code>arg</code>), binds pooled items to <code>pool-item</code> with new instances of <code>java.util.Date</code> and has a max pool size of 5. The output appends the date to the passed argument.</p>
<p>See the underlying <a href="https://commons.apache.org/proper/commons-pool/apidocs/org/apache/commons/pool2/impl/GenericObjectPool.html#setConfig-org.apache.commons.pool2.impl.GenericObjectPoolConfig">Java API</a> for more information.</p></div></div><div class="src-link"><a href="https://github.com/plandes/clj-actioncli/blob/v0.0.30/src/clojure/zensols/actioncli/util.clj#L110">view source</a></div></div><div class="public anchor" id="var-defnprime"><h3>defnprime</h3><h4 class="type">macro</h4><div class="usage"><code>(defnprime attr-map? name doc-string? [params*] body)</code><code>(defnprime name doc-string? [params*] body)</code><code>(defnprime name [params*] body)</code></div><div class="doc"><div class="markdown"><p>Just like <code>defn</code> but call <strong>body</strong> in a <a href="null">clojure.core/locking</a> lexical context to make this first call and resource creation thread-safe. Subsequent calls only use the monitor to check if the resource has <strong>body</strong> been called once.</p>
<p>This creates a function <strong>name</strong> that invokes <strong>body</strong> the first time it is invoked. It then caches the solution and returns it on the next call.</p>
<p>The result it saves is kept in the metadata under key <code>:init-resource</code>.</p></div></div><div class="src-link"><a href="https://github.com/plandes/clj-actioncli/blob/v0.0.30/src/clojure/zensols/actioncli/util.clj#L51">view source</a></div></div><div class="public anchor" id="var-parse-macro-arguments"><h3>parse-macro-arguments</h3><div class="usage"><code>(parse-macro-arguments arg-list)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/plandes/clj-actioncli/blob/v0.0.30/src/clojure/zensols/actioncli/util.clj#L37">view source</a></div></div><div class="public anchor" id="var-pool-item-status"><h3>pool-item-status</h3><div class="usage"><code>(pool-item-status pool-fn-var)</code></div><div class="doc"><div class="markdown"><p>Return statistics on the <strong>pool-fn-var</strong>. A var (not a symbole) needs to be passed, which look something like <code>'#my-pol-fn</code> for <strong>pool-fn-var</strong>.</p></div></div><div class="src-link"><a href="https://github.com/plandes/clj-actioncli/blob/v0.0.30/src/clojure/zensols/actioncli/util.clj#L163">view source</a></div></div><div class="public anchor" id="var-trunc"><h3>trunc</h3><div class="usage"><code>(trunc obj)</code><code>(trunc obj len)</code></div><div class="doc"><div class="markdown"><p>Truncate string <code>obj</code> at <code>len</code> characters adding ellipses if larger that a set length. If <code>obj</code> isnâ€™t a string use <code>pr-str</code> to make it a string.</p>
<p>See <a href="zensols.actioncli.util.html#var-*trunc-len*">*trunc-len*</a>.</p></div></div><div class="src-link"><a href="https://github.com/plandes/clj-actioncli/blob/v0.0.30/src/clojure/zensols/actioncli/util.clj#L14">view source</a></div></div><div class="public anchor" id="var-with-timeout"><h3>with-timeout</h3><h4 class="type">macro</h4><div class="usage"><code>(with-timeout timeout-millis &amp; body)</code></div><div class="doc"><div class="markdown"><p>Execute <strong>body</strong> and timeout after <strong>timeout-millis</strong> milliseconds.</p>
<p>If the execution times out <code>java.util.concurrent.TimeoutException</code> is thrown.</p></div></div><div class="src-link"><a href="https://github.com/plandes/clj-actioncli/blob/v0.0.30/src/clojure/zensols/actioncli/util.clj#L29">view source</a></div></div></div></body></html>